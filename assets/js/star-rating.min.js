!function(t){var a=function(a,e){return void 0===a||null===a||void 0===a||a==[]||""===a||e&&""===t.trim(a)},e=function(t,e,n){var l=a(t.data(e))?t.attr(e):t.data(e);return l||n[e]},n=function(t){var a=(""+t).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);return a?Math.max(0,(a[1]?a[1].length:0)-(a[2]?+a[2]:0)):0},l=function(t,a){return parseFloat(t.toFixed(a))},r=function(a,e){this.$element=t(a),this.init(e)};r.prototype={constructor:r,_parseAttr:function(t,n){var l=this.$element;if("range"===l.attr("type")||"number"===l.attr("type")){var r=e(l,t,n),i=1;"min"===t?i=0:"max"===t?i=10:"step"===t&&(i=1);var s=a(r)?i:r;return parseFloat(s)}return parseFloat(n[t])},listen:function(){var a=this;a.$rating.on("click",function(t){a.inactive||(w=t.pageX-a.$rating.offset().left,a.setStars(w),a.$element.trigger("change"),a.$element.trigger("rating.change",[a.$element.val(),a.$caption.html()]))}),a.$clear.on("click",function(t){a.inactive||a.clear()}),t(a.$element[0].form).on("reset",function(t){a.inactive||a.reset()})},initSlider:function(t){var e=this;a(e.$element.val())&&e.$element.val(0),e.initialValue=e.$element.val(),e.min=void 0!==t.min?t.min:e._parseAttr("min",t),e.max=void 0!==t.max?t.max:e._parseAttr("max",t),e.step=void 0!==t.step?t.step:e._parseAttr("step",t),(isNaN(e.min)||a(e.min))&&(e.min=0),(isNaN(e.max)||a(e.max))&&(e.max=10),(isNaN(e.step)||a(e.step)||0==e.step)&&(e.step=1),e.diff=e.max-e.min},init:function(e){var n=this;n.options=e,n.initSlider(e),n.checkDisabled(),$element=n.$element,n.containerClass=e.containerClass,n.glyphicon=e.glyphicon;var l=n.glyphicon?"":"★";n.symbol=a(e.symbol)?l:e.symbol,n.rtl=e.rtl||n.$element.attr("dir"),n.rtl&&n.$element.attr("dir","rtl"),n.showClear=e.showClear,n.showCaption=e.showCaption,n.size=e.size,n.stars=e.stars,n.defaultCaption=e.defaultCaption,n.starCaptions=e.starCaptions,n.starCaptionClasses=e.starCaptionClasses,n.clearButton=e.clearButton,n.clearButtonTitle=e.clearButtonTitle,n.clearButtonBaseClass=a(e.clearButtonBaseClass)?"clear-rating":e.clearButtonBaseClass,n.clearButtonActiveClass=a(e.clearButtonActiveClass)?"clear-rating-active":e.clearButtonActiveClass,n.clearCaption=e.clearCaption,n.clearCaptionClass=e.clearCaptionClass,n.clearValue=e.clearValue,n.$element.removeClass("form-control").addClass("form-control"),n.$clearElement=a(e.clearElement)?null:t(e.clearElement),n.$captionElement=a(e.captionElement)?null:t(e.captionElement),void 0===n.$rating&&void 0===n.$container&&(n.$rating=t(document.createElement("div")).html('<div class="rating-stars"></div>'),n.$container=t(document.createElement("div")),n.$container.before(n.$rating),n.$container.append(n.$rating),n.$element.before(n.$container).appendTo(n.$rating)),n.$stars=n.$rating.find(".rating-stars"),n.generateRating(),n.$clear=a(n.$clearElement)?n.$container.find("."+n.clearButtonBaseClass):n.$clearElement,n.$caption=a(n.$captionElement)?n.$container.find(".caption"):n.$captionElement,n.setStars(),n.$element.hide(),n.listen(),n.showClear&&n.$clear.attr({class:n.getClearClass()})},checkDisabled:function(){var t=this;t.disabled=e(t.$element,"disabled",t.options),t.readonly=e(t.$element,"readonly",t.options),t.inactive=t.disabled||t.readonly},getClearClass:function(){return this.clearButtonBaseClass+" "+(this.inactive?"":this.clearButtonActiveClass)},generateRating:function(){var t=this,e=t.renderClear(),n=t.renderCaption(),l=t.rtl?"rating-container-rtl":"rating-container",r=t.getStars();l+=t.glyphicon?""==t.symbol?" rating-gly-star":" rating-gly":" rating-uni",t.$rating.attr("class",l),t.$rating.attr("data-content",r),t.$stars.attr("data-content",r);l=t.rtl?"star-rating-rtl":"star-rating";t.$container.attr("class",l+" rating-"+t.size),t.inactive?t.$container.removeClass("rating-active").addClass("rating-disabled"):t.$container.removeClass("rating-disabled").addClass("rating-active"),void 0===t.$caption&&void 0===t.$clear&&(t.rtl?t.$container.prepend(n).append(e):t.$container.prepend(e).append(n)),a(t.containerClass)||t.$container.removeClass(t.containerClass).addClass(t.containerClass)},getStars:function(){for(var t=this,a=t.stars,e="",n=1;n<=a;n++)e+=t.symbol;return e},renderClear:function(){var t=this;if(!t.showClear)return"";var e=t.getClearClass();return a(t.$clearElement)?'<div class="'+e+'" title="'+t.clearButtonTitle+'">'+t.clearButton+"</div>":(t.$clearElement.removeClass(e).addClass(e).attr({title:t.clearButtonTitle}),t.$clearElement.html(t.clearButton),"")},renderCaption:function(){var t=this,e=t.$element.val();if(!t.showCaption)return"";var n=t.fetchCaption(e);return a(t.$captionElement)?'<div class="caption">'+n+"</div>":(t.$captionElement.removeClass("caption").addClass("caption").attr({title:t.clearCaption}),t.$captionElement.html(n),"")},fetchCaption:function(t){var e=this,n=parseFloat(t),l=a(e.starCaptionClasses[n])?e.clearCaptionClass:e.starCaptionClasses[n],r=a(e.starCaptions[n])?e.defaultCaption.replace(/\{rating\}/g,n):e.starCaptions[n];return'<span class="'+l+'">'+(n==e.clearValue?e.clearCaption:r)+"</span>"},getValueFromPosition:function(t){var a,e,r=this,i=n(r.step);return a=t/r.$rating.width(),(e=r.min+Math.ceil(r.diff*a/r.step)*r.step)<r.min?e=r.min:e>r.max&&(e=r.max),e=l(parseFloat(e),i),r.rtl&&(e=r.max-e),e},setStars:function(t){var e=this,n=e.min,l=e.max,r=(e.step,arguments.length?e.getValueFromPosition(t):a(e.$element.val())?0:e.$element.val()),i=0,s=(e.$rating.width(),e.fetchCaption(r));i=(r-n)/l*100,e.rtl&&(i=100-i),e.$element.val(r),i+="%",e.$stars.css("width",i),e.$caption.html(s)},clear:function(){var t=this,a='<span class="'+t.clearCaptionClass+'">'+t.clearCaption+"</span>";t.$stars.removeClass("rated"),t.inactive||t.$caption.html(a),t.$element.val(t.clearValue),t.setStars(),t.$element.trigger("rating.clear")},reset:function(){var t=this;t.$element.val(t.initialValue),t.setStars(),t.$element.trigger("rating.reset")},update:function(t){if(arguments.length>0){var a=this;a.$element.val(t),a.setStars()}},refresh:function(a){var e=this;if(arguments.length){e.init(t.extend(e.options,a)),e.showClear?e.$clear.show():e.$clear.hide(),e.showCaption?e.$caption.show():e.$caption.hide()}}},t.fn.rating=function(a){var e=Array.apply(null,arguments);return e.shift(),this.each(function(){var n=t(this),l=n.data("rating"),i="object"==typeof a&&a;l||n.data("rating",l=new r(this,t.extend({},t.fn.rating.defaults,i,t(this).data()))),"string"==typeof a&&l[a].apply(l,e)})},t.fn.rating.defaults={stars:5,glyphicon:!0,symbol:null,disabled:!1,readonly:!1,rtl:!1,size:"md",showClear:!0,showCaption:!0,defaultCaption:"{rating} 颗星",starCaptions:{1:"3颗星",2:"2颗星",3:"3颗星",4:"4颗星",5:"5颗星",6:"6颗星",7:"7颗星",8:"8颗星",9:"9颗星",10:"10颗星"},starCaptionClasses:{1:"label label-danger",2:"label label-danger",3:"label label-warning",4:"label label-warning",5:"label label-info",6:"label label-info",7:"label label-primary",8:"label label-primary",9:"label label-success",10:"label label-success"},clearButton:'<i class="glyphicon glyphicon-minus-sign"></i>',clearButtonTitle:"Clear",clearButtonBaseClass:"clear-rating",clearButtonActiveClass:"clear-rating-active",clearCaption:"还没评分",clearCaptionClass:"label label-default",clearValue:0,captionElement:null,clearElement:null,containerClass:null},t(document).ready(function(){var a=t("input.rating");Object.keys(a).length>0&&a.rating()})}(jQuery);